# Задание 3. Работа с Ansible

### Текст задания
Автоматизировать с помощью Ansible процесс:

1. Установки Docker на целевом хосте (локальном или удаленном).
   
2. Проверки на целевом хосте работоспособность Bash-скрипта/python-скрипта внутри Docker-контейнера (аналогично 2 разделу, проверка работоспособности через docker logs)

3. Доп. задание, по желанию, реализовать автоматическую проверку вместо docker logs на хосте, выполнить docker logs с помощью ansible.

### Требования
<details>
<summary> Много, так что тут </summary>
  
**Установка Docker**

а) Playbook должен:

• Определять целевую систему (может быть localhost или указанный в инвентаре хост).

• Устанавливать Docker и необходимые зависимости.

• Добавлять текущего пользователя в группу docker (чтобы избежать sudo при работе с Docker).

• Запускать и включать службу docker.service.

b) Проверять:

• успешность установки (например, командой docker --version).

**Проверка работы скрипта в контейнере**

a) Playbook должен:

• Собирать Docker-образ (если требуется) или использовать готовый.

• Запускать контейнер с Bash-скриптом или python-скриптом.

b) Проверять:

• Корректность выполнения скрипта (код завершения 0).

• Проверить результат через docker logs

**Автоматическая проверка работы скрипта в контейнере**

а) Playbook должен:

• Проверять:

• Корректность выполнения скрипта (код завершения 0).

• Выводить результат через docker logs

</details>

### Инструкция к запуску и результаты выполнения

Для запуска плейбука выполнить команду: 

    sudo ansible-playbook -i inventory/hosts playbook.yaml

Результат работы скрипта (точнее последнего блока):

    TASK [Вывод логов] **************************************************************************************************************************************************
    ok: [localhost] => {
    "container_logs.stderr_lines": [
        "2025-05-06 19:43:49,138 - INFO - Успешный запрос 101: ",
        "2025-05-06 19:43:49,837 - INFO - Успешный запрос 200: 200 OK",
        "2025-05-06 19:43:50,519 - INFO - Успешный запрос 300: 300 Multiple Choices",
        "2025-05-06 19:43:51,195 - ERROR - Ошибка 404: 404 Not Found",
        "2025-05-06 19:43:51,860 - ERROR - Ошибка 501: 501 Not Implemented"
    ]
    }
Ну и с хоста тоже работает:

    nika@nika-vb:~/ansible-test-task/app$ docker logs script
    2025-05-06 19:43:49,138 - INFO - Успешный запрос 101: 
    2025-05-06 19:43:49,837 - INFO - Успешный запрос 200: 200 OK
    2025-05-06 19:43:50,519 - INFO - Успешный запрос 300: 300 Multiple Choices
    2025-05-06 19:43:51,195 - ERROR - Ошибка 404: 404 Not Found
    2025-05-06 19:43:51,860 - ERROR - Ошибка 501: 501 Not Implemented

